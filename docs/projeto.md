# Iniciando o projeto

<figure markdown>
  ![Blueprint do projeto](imgs/blueprint.jpg)
  <figcaption></figcaption>
</figure>

J√° temos as esp√°tulas, facas, colheres e outros instrumentos na mesa, mas para prosseguirmos, precisamos escolher os melhores ingredientes.

Desenvolver um projeto n√£o significa escrever tudo do zero e poderemos contar com ajuda de trechos escritos por outros programadores. estes trechos comuns de c√≥digo s√£o chamados bibliotecas e vamos acabar adicionando algumas ao nosso projeto.

Mas antes de tudo, precisamos iniciar nosso projeto.

## ‚ñ∂Ô∏è Come√ßando a tirar do papel o projeto

Daremos nosso primeiro passo, criando um diret√≥rio onde ser√£o armazenados todos os arquivos do projeto.

Faremos isto utilizando o github, que √© uma plataforma gratuita, muita conhecida e que ir√° nos ajudar com algumas integra√ß√µes no futuro.

Mas por que iniciaremos criando o projeto l√° e n√£o no pr√≥prio computador?

O primeiro motivo √© que j√° criaremos o projeto com controle de vers√£o, ou seja a cada passo da sua cria√ß√£o vamos salvando as altera√ß√µes, evitando que os passos se percam e caso necess√°rio podemos desfazer algum passo errado.

Outro motivo √© que se algo acontecer com seu computador, teremos salvo uma vers√£o do projeto.

Abra seu navegador, e acesse o seguinte endere√ßo http://github.com. Crie uma conta se ainda n√£o tiver.

Aperte o bot√£o novo_reposit√≥rio.

![novo reposit√≥rio](imgs/novo_repositorio.png " Novo reposit√≥rio")

Preencha os campos como visto na imagem abaixo.

!!! warning
    
    As setas indicam o que deve ser preenchido.

![novo reposit√≥rio](imgs/novorepo.png "Novo reposit√≥rio")

Agora fa√ßa um "clone" do seu reposit√≥rio.

!!! warning
    
    Os comandos abaixo devem ser modificados com seu email e nome de usu√°rio do github. USUARIO deve ser modificado para seu usu√°rio do github e EMAIL substituido pelo email utilizado no github.

```bash
$ git clone https://github.com/USUARIO/gerenciador-tarefas.git
Cloning into 'gerenciador-tarefas'...
remote: Counting objects: 5, done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 5 (delta 0), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (5/5), done.

```

`git clone` √© um comando para criar uma c√≥pia dos arquivos e suas vers√µes. Pode ser feito para trazer uma c√≥pia do reposit√≥rio do servidor para o computador local.

Aproveite e j√° configure seu usu√°rio git para este projeto, dentro do diret√≥rio rec√©m clonado digite os seguintes comandos.

```bash
$ git config --local user.email EMAIL

$ git config --local user.name USUARIO
```

"Voil√†", j√° temos o projeto iniciado.

Navegue at√© o diret√≥rio onde foi executado o comando de `clone` do projeto. Prossiga com a instala√ß√£o das bibliotecas de acordo com o seu sistema operacional.

!!! warning
    
    N√£o se esque√ßa de entrar no diret√≥rio do projeto antes de continuar a instala√ß√£o das bibliotecas.

## üñ•Ô∏è O ambiente virtual

Iniciei um projeto e ele utiliza a biblioteca fastapi na vers√£o 0.2, tr√™s meses depois fui iniciar outro e a vers√£o do fastapi j√° era 0.3.

Ser√° que n√£o d√° problema se eu mudar no primeiro projeto? Ou ser√° que mudo no segundo?

Para evitar este tipo de problema, vamos criar o que chamaremos de ambiente virtual.

Na pr√°tica o que vamos fazer √© instalar as bibliotecas em um diret√≥rio que est√° relacionado ao projeto. Assim cada projeto pode ter suas pr√≥prias bibliotecas na vers√£o que quiser.

O comando para isto √© `python3 -m venv .venv`, ou `python -m venv .venv` no windows, sendo que .venv √© o nome deste ambiente isolado.

Este ambiente isolado ser√° visto como um diret√≥rio criado na pasta do projeto.

O ponto na frente do nome faz com que o diret√≥rio fique oculto.

Depois de criado, temos de ativar este ambiente e isto √© importante pois sempre que decidir trabalhar neste projeto voc√™ dever√° repetir este passo.

Digite o comando: `source .venv/bin/activate` em linux ou `.venv\Scripts\activate.bat` no windows.

Pronto, agora estamos preparados para instalar as bibliotecas que precisaremos.

# üìö Bibliotecas e utilit√°rios

Chegou a hora de instalar algumas bibliotecas e utilit√°rios que nos auxiliar√£o na cria√ß√£o do nosso sistema web, na realiza√ß√£o de testes unit√°rios e testes manuais.

Siga os passos de acordo com o seu sistema operacional para cada ferramenta. Tenha sempre certeza de que a ferramenta est√° instalada e funcionando.

!!! warning
    
    Certifique-se de que seu ambiente est√° ativo antes de prosseguir com as instala√ß√µes.

### ‚ö° FastAPI

**O que √©?**

O [fastapi](https://fastapi.tiangolo.com) √© uma ferramenta para desenvolvimento web, possui alta performance, f√°cil de aprender, r√°pida para escrever c√≥digo e pronta para colocar o c√≥digo no ar.

**Para que serve?**

Serve para escrevermos nossa aplica√ß√£o web de forma r√°pida e customiz√°vel.

Possui fun√ß√µes que auxiliam opera√ß√µes como roteamento, tratamento de requisi√ß√µes, renderiza√ß√£o de conte√∫do, gerenciamento de sess√£o e cookies, assim como v√°rias outras que s√£o t√≠picas da web.

**Como instalar**

!!! warning
    
    Preste aten√ß√£o que os comandos ser√£o executados dentro do diret√≥rio do projeto.

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Navegue ate o nosso projeto e agora digite `pip install fastapi`.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal, navegue at√© a pasta do projeto e por fim digite `pip install fastapi`.

**Vamos verificar se deu tudo certo?**

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Agora digite `python -c "import fastapi"`. nenhum erro deve ocorrer.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal e digite `python -c "import fastapi"`. nenhum erro deve ocorrer.

### üîó Httpie

**O que √©?**

[HTTPie](https://github.com/jakubroztocil/httpie) √© um cliente HTTP por linha de comando. Seu objetivo √© transformar a intera√ß√£o com servi√ßos web o mais humano poss√≠vel.

**Para que serve?**

Diversos momentos do curso, teremos de testar manualmente se nosso sistema est√° funcionando, ainda que possua testes automatizados.

Esta ferramenta ajuda a fazer estes testes de uma maneira mais simples.

**Como instalar**

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Navegue ate o nosso projeto e agora digite `pip install httpie`.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal, navegue at√© a pasta do projeto e por fim digite `pip install httpie`.

**Vamos verificar se deu tudo certo?**

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Agora digite `http --version`.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal e digite `http --version`.

!!! warning
    
    Note que foi utilizado o comando http ao inv√©s de httpie, este √© o nome do execut√°vel do httpie depois de instalado no sistema.

A sa√≠da para ambos os sistemas operacionais dever√° ser similar a apresentada abaixo:

```bash
$ http --version
1.0.3
```

### ü¶Ñ Uvicorn

**O que √©?**

O uvicorn √© um servidor de aplica√ß√£o com suporte a frameworks ass√≠ncronos.

**Para que serve?**

O uvicorn serve para rodar a nossa aplica√ß√£o, tanto na nossa m√°quina quanto em um servidor na internet.

**Como instalar**

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Navegue ate o nosso projeto, ative o ambiente virtual e agora digite `pip install uvicorn`.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal, navegue at√© a pasta do projeto, ative o ambiente virtual e por fim digite `pip
install uvicorn`.

**Vamos verificar se deu tudo certo?**

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Ative o ambiente virtual, Agora digite `uvicorn --help`.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal e digite `uvicorn --help`.

A sa√≠da para ambos os sistemas operacionais dever√° ser similar a apresentada abaixo:

```bash
Usage: uvicorn [OPTIONS] APP

Options:
  --host TEXT                     Bind socket to this host.  [default:
                                  127.0.0.1]
  --port INTEGER                  Bind socket to this port.  [default: 8000]
  --uds TEXT                      Bind to a UNIX domain socket.
  --fd INTEGER                    Bind to socket from this file descriptor.
  --reload                        Enable auto-reload.
  --reload-dir TEXT               Set reload directories explicitly, instead
                                  of using the current working directory.
  --workers INTEGER               Number of worker processes. Defaults to the
                                  $WEB_CONCURRENCY environment variable if
                                  available. Not valid with --reload.
  --loop [auto|asyncio|uvloop|iocp]
                                  Event loop implementation.  [default: auto]
  --http [auto|h11|httptools]     HTTP protocol implementation.  [default:
                                  auto]
  --ws [auto|none|websockets|wsproto]
                                  WebSocket protocol implementation.
                                  [default: auto]
  --lifespan [auto|on|off]        Lifespan implementation.  [default: auto]
  --interface [auto|asgi3|asgi2|wsgi]
                                  Select ASGI3, ASGI2, or WSGI as the
                                  application interface.  [default: auto]
  --env-file PATH                 Environment configuration file.
  --log-config PATH               Logging configuration file.
  --log-level [critical|error|warning|info|debug|trace]
                                  Log level. [default: info]
  --access-log / --no-access-log  Enable/Disable access log.
  --proxy-headers / --no-proxy-headers
                                  Enable/Disable X-Forwarded-Proto,
                                  X-Forwarded-For, X-Forwarded-Port to
                                  populate remote address info.
  --forwarded-allow-ips TEXT      Comma seperated list of IPs to trust with
                                  proxy headers. Defaults to the
                                  $FORWARDED_ALLOW_IPS environment variable if
                                  available, or '127.0.0.1'.
  --root-path TEXT                Set the ASGI 'root_path' for applications
                                  submounted below a given URL path.
  --limit-concurrency INTEGER     Maximum number of concurrent connections or
                                  tasks to allow, before issuing HTTP 503
                                  responses.
  --limit-max-requests INTEGER    Maximum number of requests to service before
                                  terminating the process.
  --timeout-keep-alive INTEGER    Close Keep-Alive connections if no new data
                                  is received within this timeout.  [default:
                                  5]
  --ssl-keyfile TEXT              SSL key file
  --ssl-certfile TEXT             SSL certificate file
  --ssl-version INTEGER           SSL version to use (see stdlib ssl module's)
                                  [default: 2]
  --ssl-cert-reqs INTEGER         Whether client certificate is required (see
                                  stdlib ssl module's)  [default: 0]
  --ssl-ca-certs TEXT             CA certificates file
  --ssl-ciphers TEXT              Ciphers to use (see stdlib ssl module's)
                                  [default: TLSv1]
  --header TEXT                   Specify custom default HTTP response headers
                                  as a Name:Value pair
  --help                          Show this message and exit.

```

### üö¶ Pytest

**O que √©?**

O framework [pytest](https://docs.pytest.org/en/latest/) √© f√°cil para escrever teste simples, ainda escala para suportar testes funcionais complexos para aplica√ß√µes e bibliotecas.

**Para que serve?**

J√° dizia Michael C. Feathers, "Um c√≥digo sem testes, √© um c√≥digo ruim. N√£o importa qu√£o bem ele foi escrito".  Vamos ent√£o instalar o pytest, que √© uma ferramenta que auxilia na execu√ß√£o de testes.

**Como instalar**

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Navegue ate o nosso projeto e agora digite `pip install pytest`.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal, navegue at√© a pasta do projeto e por fim digite `pip install pytest`.

**Vamos verificar se deu tudo certo?**

=== "üñ•Ô∏è Windows"

    Clique no bot√£o iniciar, digite `cmd` e abra o programa `prompt de comandos`. Agora digite `pytest --version`.

=== "üêßüçé Ubuntu/Mac"

    Abra um terminal e digite `pytest --version`.

A sa√≠da para ambos os sistemas operacionais dever√° ser similar a apresentada abaixo:

```bash
$ pytest --version
This is pytest version 5.3.0, imported from /home/cassiobotaro/projects/gerenciador-tarefas/.venv/lib/python3.8/site-packages/pytest.py
```

## ‚ö†Ô∏è Nota importante sobre ambientes virtuais

Se neste momento, voc√™ digitar `cmd` no windows, ou abrir um terminal no linux e digitar `python3` ou `python` no windows, e em seguida tentar importar a bilbioteca fastapi o seguinte erro ser√° mostrado. üò±

```bash
$ python3
Python 3.8.0 (default, Oct 16 2019, 11:21:38)
[GCC 9.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import fastapi
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ModuleNotFoundError: No module named 'fastapi'
>>>
```
!!! tip

    Utilize `Ctrl + d` ou `exit()` para sair do python.

Acontece que instalamos o FastAPI somente no ambiente virtual. Para entrarmos no ambiente virtual digite `source <venv>/bin/activate` ou `<venv>\Scripts\activate.bat`.

N√£o esque√ßa de trocar o `<venv>` pelo nome do ambiente virtual criado. Por exemplo, se voc√™ seguiu esse tutorial, provavelmente voc√™ usou o nome `.venv`, ent√£o o comando ser√° `source .venv/bin/activate` ou `.venv\Scripts\activate.bat`.

## Salvando o momento atual do nosso projeto

Neste momento seu diret√≥rio deve estar assim:

```
.
‚îú‚îÄ‚îÄ LICENSE
‚îî‚îÄ‚îÄ README.md
```

E se eu te pedisse agora uma c√≥pia do projeto, como eu saberia de toda essa lista de coisas necess√°rias pro c√≥digo rodar?

Para evitar este problema criaremos arquivos com as depend√™ncias que instalamos no nosso projeto.

Vamos come√ßar criando um arquivo chamado requirements.txt com o seguinte conte√∫do.

```
fastapi==0.45.0
uvicorn==0.11.1
```

Depois criaremos um segundo arquivo chamado `dev-requirements.txt` e colocaremos o seguinte conte√∫do.

```
-r requirements.txt
pytest==5.3.2
httpie==1.0.3
```

!!! warning
    
    Os arquivos devem ser criados na pasta principal do projeto. Teremos ent√£o os seguintes arquivos no nosso diret√≥rio.

```
.
‚îú‚îÄ‚îÄ LICENSE
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ dev-requirements.txt
‚îî‚îÄ‚îÄ requirements.txt
```

Por que arquivos separados?

No `requirements.txt`, s√≥ colocamos aquelas bibliotecas realmente necess√°rias para o sistema ir ao ar, j√° no `dev-requirements.txt`, temos as dep√™ndencias que somente s√£o √∫teis enquanto estamos desenvolvendo o sistema.

Aquele `-r requirements.txt` no arquivo de desenvolvimento garante que as depend√™ncias principais ser√£o instaladas e em seguidas as outras que somente s√£o √∫teis durante o desenvolvimento.

Quando formos colocar o site no ar, estes arquivos ser√£o bem √∫teis.

Instalado as depend√™ncias, vamos salvar uma primeira vers√£o do nosso projeto com o nosso andamento?

Primeiro passo √© checar o que foi feito at√© agora:

```bash
$ git status
On branch master
Your branch is up to date with 'origin/master'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	dev-requirements.txt
	requirements.txt

nothing added to commit but untracked files present (use "git add" to track)
```

Vemos dois arquivos n√£o rastreados, precisamos avisar ao controle de vers√£o que monitore estes arquivos.

`$ git add requirements.txt dev-requirements.txt`

üíæ Agora vamos marcar esta vers√£o como salva.

`git commit -m "adicionando depend√™ncias do projeto"`

üîß Por fim, envie ao github a vers√£o atualizada do projeto.

`git push`

üç∞ Entusiasmados a come√ßar a escrever sua aplica√ß√£o? Agora que temos todo o ambiente configurado, j√° estamos bem pr√≥ximo disso, faremos um nivelamento de conhecimento sobre web e python e em breve termos nossa aplica√ß√£o no ar!
